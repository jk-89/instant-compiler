# Compiler for the Instant Language for JVM and LLVM

A compiler for the [Instant](https://www.mimuw.edu.pl/~ben/Zajecia/Mrj2023/instant-en.html) programming language, implemented in Haskell. Instant is a small, imperative language designed for initializing variables and performing various mathematical operations. The compiler generates both [LLVM](https://en.wikipedia.org/wiki/LLVM) (Low Level Virtual Machine) and [JVM](https://en.wikipedia.org/wiki/Java_virtual_machine) (Java Virtual Machine) code.

As an optimization, the order of operations on the subexpressions is arranged to minimize the stack size in the JVM, resulting in more efficient memory usage in the generated code.

## Example
```
x = 1;
y = 2;
z = 3;
a = x * y * z + 10;
a - 3
```
This would generate code that performs the given operations and outputs `13`.

## Usage

* `make` creates the executable files `insc_jvm` and `insc_llvm` in the root directory.
* `./insc_jvm program.ins` for a valid input program creates the `program.j` and `program.class` files.
* `./insc_llvm progam.ins` for a valid input program creates the `program.ll` and `program.bc` files.
* `make clean` works as expected.

## Project Structure

* The `Grammar` directory containing files generated by running BNFC on the provided grammar `Instant.cf`.
* The `JVM` and `LLVM` directories. Both contain three programs written in Haskell.
  - `Compiler.hs` file is responsible for transforming the program's abstract syntax tree into JVM or LLVM code.
  - `Main.hs` handles parsing the input and output of the program.
  - `Structure.hs` describes the used monads and several functions that facilitate working with them.
